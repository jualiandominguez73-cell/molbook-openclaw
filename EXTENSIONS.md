# ğŸ”§ Moltbot æ‰©å±•åŠŸèƒ½å·¥å…·é›†

**ç‰ˆæœ¬**: v2.1
**æœ€åæ›´æ–°**: 2026-01-29

---

## ğŸ“¦ æ–°å¢å·¥å…·æ¦‚è§ˆ

æœ¬æ–‡æ¡£æè¿°äº†åœ¨ v2.0 åŸºç¡€ä¸Šæ–°å¢çš„æ‰©å±•å·¥å…·å’ŒåŠŸèƒ½ã€‚

---

## 1. SSL/TLS é…ç½®å‘å¯¼

**æ–‡ä»¶**: `setup-ssl.bat`

### åŠŸèƒ½
è‡ªåŠ¨é…ç½® HTTPS/WSS åŠ å¯†é€šä¿¡

### æ”¯æŒæ¨¡å¼
- è‡ªç­¾åè¯ä¹¦ï¼ˆå¿«é€Ÿæµ‹è¯•ï¼‰
- Let's Encryptï¼ˆå…è´¹ï¼Œéœ€è¦åŸŸåï¼‰
- ä½¿ç”¨ç°æœ‰è¯ä¹¦

### ä½¿ç”¨æ–¹æ³•
```batch
setup-ssl.bat
```

### é…ç½®å†…å®¹
- Nginx åå‘ä»£ç†
- SSL è¯ä¹¦è‡ªåŠ¨å®‰è£…
- Gateway WSS æ”¯æŒ
- Grafana HTTPS æ”¯æŒ

---

## 2. æ—¥å¿—èšåˆåˆ†æå™¨

**æ–‡ä»¶**: `/opt/moltbot-monitoring/log-analyzer.py` (æœåŠ¡å™¨)

### åŠŸèƒ½
å®æ—¶æ—¥å¿—èšåˆã€åˆ†æå’Œå‘Šè­¦

### API ç«¯ç‚¹
```
GET /api/logs/summary    - æ—¥å¿—æ‘˜è¦
GET /api/logs/events     - æœ€è¿‘äº‹ä»¶
GET /api/logs/health     - å¥åº·çŠ¶æ€
GET /api/logs/service?service=<name>  - ç‰¹å®šæœåŠ¡æ—¥å¿—
```

### ç›‘æ§çš„æ—¥å¿—
- Gateway æ—¥å¿—
- æ•°æ®åº“ API æ—¥å¿—
- å¤‡ä»½æ—¥å¿—
- åŒæ­¥æ—¥å¿—
- å¥åº·æ£€æŸ¥æ—¥å¿—
- ç³»ç»Ÿè®¤è¯æ—¥å¿—

### ä½¿ç”¨ç¤ºä¾‹
```bash
# è·å–æ—¥å¿—æ‘˜è¦
curl http://38.14.254.51:9102/api/logs/summary

# è·å–å¥åº·çŠ¶æ€
curl http://38.14.254.51:9102/api/logs/health
```

---

## 3. æ€§èƒ½ä¼˜åŒ–è„šæœ¬

**æ–‡ä»¶**: `/usr/local/bin/moltbot-optimize.sh` (æœåŠ¡å™¨)

### ä¼˜åŒ–é¡¹ç›®
1. **ç³»ç»Ÿå‚æ•°ä¼˜åŒ–**
   - ç½‘ç»œè¿æ¥æ•°
   - æ–‡ä»¶æè¿°ç¬¦é™åˆ¶
   - å…±äº«å†…å­˜é…ç½®
   - è™šæ‹Ÿå†…å­˜å‚æ•°

2. **PostgreSQL ä¼˜åŒ–**
   - å†…å­˜åˆ†é…
   - è¿æ¥æ± é…ç½®
   - WAL è®¾ç½®
   - æŸ¥è¯¢ä¼˜åŒ–

3. **Docker ä¼˜åŒ–**
   - æ—¥å¿—å¤§å°é™åˆ¶
   - å­˜å‚¨é©±åŠ¨é…ç½®
   - å¹¶å‘ä¸‹è½½é™åˆ¶

4. **æ—¥å¿—æ¸…ç†**
   - è‡ªåŠ¨å‹ç¼©æ—§æ—¥å¿—
   - åˆ é™¤è¿‡æœŸæ—¥å¿—
   - Journal æ—¥å¿—æ¸…ç†

5. **ç£ç›˜ I/O ä¼˜åŒ–**
   - I/O è°ƒåº¦å™¨è®¾ç½®
   - Swap é…ç½®

### ä½¿ç”¨æ–¹æ³•
```bash
# SSH åˆ°æœåŠ¡å™¨
ssh root@38.14.254.51

# è¿è¡Œä¼˜åŒ–
/usr/local/bin/moltbot-optimize.sh
```

---

## 4. å¥åº·æ£€æŸ¥æŠ¥å‘Š

**æ–‡ä»¶**: `/usr/local/bin/moltbot-health-report.py` (æœåŠ¡å™¨)

### åŠŸèƒ½
ç”Ÿæˆæ¯æ—¥å¥åº·æŠ¥å‘Šå¹¶å¯é€‰å‘é€é‚®ä»¶

### æŠ¥å‘Šå†…å®¹
- ç³»ç»ŸæŒ‡æ ‡ï¼ˆCPUã€å†…å­˜ã€ç£ç›˜ã€è´Ÿè½½ï¼‰
- æœåŠ¡çŠ¶æ€
- æ•°æ®åº“ç»Ÿè®¡
- æœ€è¿‘é—®é¢˜åˆ—è¡¨

### ä½¿ç”¨æ–¹æ³•
```bash
# ç”ŸæˆæŠ¥å‘Š
/usr/local/bin/moltbot-health-report.py

# æŸ¥çœ‹æŠ¥å‘Š
cat /opt/moltbot-monitoring/reports/report_*.txt
```

### é…ç½®è‡ªåŠ¨å‘é€
ç¼–è¾‘ `/opt/moltbot-monitoring/alert-config.json`:
```json
{
  "email": {
    "enabled": true,
    "smtp_host": "smtp.gmail.com",
    "smtp_port": 587,
    "smtp_user": "your-email@gmail.com",
    "smtp_password": "your-app-password",
    "to_email": "admin@example.com"
  }
}
```

### é…ç½®å®šæ—¶ä»»åŠ¡
```bash
# æ¯å¤©æ—©ä¸Š 8 ç‚¹ç”ŸæˆæŠ¥å‘Š
0 8 * * * root /usr/local/bin/moltbot-health-report.py
```

---

## 5. é›†ç¾¤æ‰©å®¹å·¥å…·

**æ–‡ä»¶**: `cluster-scaler.bat`

### åŠŸèƒ½
äº¤äº’å¼é›†ç¾¤ç®¡ç†ç•Œé¢

### æ”¯æŒæ“ä½œ
1. æŸ¥çœ‹é›†ç¾¤çŠ¶æ€
2. æ·»åŠ æ–°è®¾å¤‡
3. ç§»é™¤è®¾å¤‡
4. é…ç½®è´Ÿè½½å‡è¡¡
5. å¯ç”¨æ•…éšœè½¬ç§»
6. ç”Ÿæˆé›†ç¾¤æŠ¥å‘Š
7. æ‰©å®¹ï¼ˆå¢åŠ èµ„æºï¼‰
8. ç¼©å®¹ï¼ˆå‡å°‘èµ„æºï¼‰

### ä½¿ç”¨æ–¹æ³•
```batch
cluster-scaler.bat
```

### èœå•å¯¼èˆª
```
[1] View current cluster status    - æŸ¥çœ‹é›†ç¾¤çŠ¶æ€
[2] Add new device to cluster      - æ·»åŠ è®¾å¤‡
[3] Remove device from cluster     - ç§»é™¤è®¾å¤‡
[4] Configure load balancing      - è´Ÿè½½å‡è¡¡é…ç½®
[5] Enable failover mode           - æ•…éšœè½¬ç§»é…ç½®
[6] Generate cluster report        - ç”Ÿæˆé›†ç¾¤æŠ¥å‘Š
[7] Scale up (add resources)       - æ‰©å®¹
[8] Scale down (remove resources)  - ç¼©å®¹
```

---

## ğŸ“Š æœåŠ¡ç«¯å£æ±‡æ€»

| æœåŠ¡ | ç«¯å£ | è¯´æ˜ |
|------|------|------|
| Gateway | 18789 | WebSocket ç½‘å…³ |
| Database API | 18800 | REST API |
| Prometheus | 9090 | æŒ‡æ ‡é‡‡é›† |
| Grafana | 3000 | å¯è§†åŒ– |
| Log Analyzer | 9102 | æ—¥å¿—åˆ†æ |
| Metrics Exporter | 9101 | æŒ‡æ ‡å¯¼å‡º |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. é…ç½® SSL åŠ å¯†
```batch
setup-ssl.bat
```

### 2. è¿è¡Œæ€§èƒ½ä¼˜åŒ–
```bash
ssh root@38.14.254.51 "/usr/local/bin/moltbot-optimize.sh"
```

### 3. æ·»åŠ æ–°è®¾å¤‡åˆ°é›†ç¾¤
```batch
cluster-scaler.bat
# é€‰æ‹© [2] Add new device
```

### 4. ç”Ÿæˆå¥åº·æŠ¥å‘Š
```bash
ssh root@38.14.254.51 "/usr/local/bin/moltbot-health-report.py"
```

---

## ğŸ“ ç»´æŠ¤ä»»åŠ¡

### æ¯æ—¥
- æ£€æŸ¥å¥åº·æŠ¥å‘Š
- ç›‘æ§æ—¥å¿—åˆ†æå™¨å‘Šè­¦
- éªŒè¯å¤‡ä»½å®Œæˆ

### æ¯å‘¨
- å®¡æŸ¥ç³»ç»Ÿæ€§èƒ½
- æ£€æŸ¥ç£ç›˜ä½¿ç”¨
- æ¸…ç†æ—§æ—¥å¿—

### æ¯æœˆ
- å®¡æŸ¥å®‰å…¨æ›´æ–°
- æµ‹è¯•å¤‡ä»½æ¢å¤
- æ€§èƒ½è°ƒä¼˜è¯„ä¼°

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- `DEPLOYMENT-COMPLETE.md` - å®Œæ•´éƒ¨ç½²æŒ‡å—
- `ROADMAP.md` - åŠŸèƒ½è·¯çº¿å›¾
- `admin-panel.html` - Web ç®¡ç†é¢æ¿

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **SSL è¯ä¹¦**
   - è‡ªç­¾åè¯ä¹¦ä¼šæ˜¾ç¤ºæµè§ˆå™¨è­¦å‘Š
   - Let's Encrypt éœ€è¦åŸŸåå’Œ 80 ç«¯å£

2. **æ€§èƒ½ä¼˜åŒ–**
   - PostgreSQL é‡å¯ä¼šçŸ­æš‚ä¸­æ–­æœåŠ¡
   - å»ºè®®åœ¨ç»´æŠ¤çª—å£æ‰§è¡Œ

3. **é›†ç¾¤æ‰©å®¹**
   - æ·»åŠ è®¾å¤‡éœ€è¦ç‰©ç†è®¿é—®æˆ–è¿œç¨‹è®¿é—®
   - ç¡®ä¿ç½‘ç»œè¿æ¥ç¨³å®š

4. **æ—¥å¿—åˆ†æ**
   - æ—¥å¿—æ–‡ä»¶å¯èƒ½å¾ˆå¤§
   - å®šæœŸæ¸…ç†æ—§æ—¥å¿—

---

## ğŸ†˜ æ•…éšœæ’é™¤

### SSL é…ç½®å¤±è´¥
```bash
# æ£€æŸ¥ Nginx é…ç½®
nginx -t

# æŸ¥çœ‹ Nginx æ—¥å¿—
journalctl -u nginx -n 50
```

### æ—¥å¿—åˆ†æå™¨æ— æ³•å¯åŠ¨
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
systemctl status moltbot-log-analyzer

# æŸ¥çœ‹æ—¥å¿—
journalctl -u moltbot-log-analyzer -n 50
```

### æ€§èƒ½ä¼˜åŒ–åé—®é¢˜
```bash
# æ¢å¤é»˜è®¤é…ç½®
sysctl --system

# é‡å¯ PostgreSQL
systemctl restart postgresql
```

---

**ğŸ‰ æ‰©å±•åŠŸèƒ½å·²å°±ç»ªï¼ŒæŒ‰éœ€ä½¿ç”¨ï¼**
